!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ArtsLicensePro=t():e.ArtsLicensePro=t()}(this,(()=>(()=>{"use strict";var e={};const{__:t}=wp.i18n,a=({label:e,icon:a,showWrapper:s=!0,renderAsLink:n=!0,href:r,text:c,status:i="default",openInNewWindow:o=!0})=>{const l=c||t("Get Pro","arts-license-pro"),p=`arts-license-pro-badge${"default"!==i?` arts-license-pro-badge_${i}`:""}`,d=n&&r?React.createElement("a",{href:r,className:p,...o&&{target:"_blank",rel:"noopener noreferrer"}},l):React.createElement("span",{className:p},l);return s?React.createElement("span",{className:"arts-license-pro-badge-wrapper"},a&&React.createElement("span",{className:`dashicons ${a}`}),e&&React.createElement("span",{className:"arts-license-pro-badge-wrapper__label"},e),d):d},{useState:s,useEffect:n}=wp.element,{Button:r,TextControl:c}=wp.components,{dateI18n:i}=wp.date,{__:o}=wp.i18n;function l({onActivate:e,onDeactivate:t,onRefresh:l,isLoading:p,licenseKey:d,isActivated:u,license:m,apiError:h,licenseConfig:f,shouldRefreshPageOnLicenseChange:_=!1,shouldAutoRefreshLicenseOnMount:w=!1}){const[y,g]=s(d||""),[v,E]=s(null),[R,L]=s(!1),[X,k]=s(!1);n((()=>{w&&u&&b()}),[]);const b=async()=>{k(!0);try{await l()}catch(e){L(!0)}finally{k(!1)}},A=async()=>{const t=(a=y)&&0!==a.trim().length?null:o("License key is required","arts-license-pro");var a;if(t)E(t);else{E(null);try{await e(y),_&&window.location.reload()}catch(e){L(!0)}}},N=e=>React.createElement("span",{className:"arts-license-pro-error"},React.createElement("span",{className:"arts-license-pro-error__icon"},"✕"),e);let x=null;if(v)x=N(v);else if(R&&h)x=N(h);else if(u&&m){const e=[],t=m.is_local?o("Activated (staging domain)","arts-license-pro"):o("Activated","arts-license-pro");if(e.push(React.createElement("li",{key:"status"},React.createElement("div",{className:"arts-license-pro-status-badge arts-license-pro-status-badge_valid "+(X?"arts-license-pro-status-badge_refreshing":"arts-license-pro-status-badge_clickable"),onClick:X?void 0:b,title:X?"":o("Click to refresh","arts-license-pro")},React.createElement("span",{className:"arts-license-pro-status-badge__icon"},X?"⟳":"✓"),React.createElement("span",{className:"arts-license-pro-status-badge__text"},X?o("Checking license...","arts-license-pro"):t)))),m.date_purchased){const t=m.date_purchased.split(" ")[0]||m.date_purchased,a=i("M d, Y",t);e.push(React.createElement("li",{key:"purchased"},"✓ ",o("Purchased on","arts-license-pro")," ",a))}if(m.date_supported_until){const t=m.date_supported_until.split(" ")[0]||m.date_supported_until,s=new Date(t),n=new Date;n.setHours(0,0,0,0);const r=s<n,c=i("M d, Y",t),l=r?"warning":"success",p=r?f.renewSupportUrl:f.supportUrl,d=o(r?"Renew Support":"Get Support","arts-license-pro");r?e.push(React.createElement("li",{key:"support",className:"arts-license-pro-error"},React.createElement("span",{className:"arts-license-pro-error__icon"},"✕"),o("Support Expired Since","arts-license-pro")," ",c," ",React.createElement(a,{showWrapper:!1,renderAsLink:!0,href:p,text:d,status:l}))):e.push(React.createElement("li",{key:"support"},"✓ ",o("Supported Until","arts-license-pro")," ",c," ",React.createElement(a,{showWrapper:!1,renderAsLink:!0,href:p,text:d,status:l})))}if(m.date_updates_provided_until)if("lifetime"===m.date_updates_provided_until)e.push(React.createElement("li",{key:"updates"},"✓ ",o("Lifetime Updates","arts-license-pro")));else{const t=m.date_updates_provided_until.split(" ")[0]||m.date_updates_provided_until,a=new Date(t),s=new Date;s.setHours(0,0,0,0);const n=a<s,r=i("M d, Y",t);n?e.push(React.createElement("li",{key:"updates",className:"arts-license-pro-error"},React.createElement("span",{className:"arts-license-pro-error__icon"},"✕"),o("Updates Expired on","arts-license-pro")," ",r)):e.push(React.createElement("li",{key:"updates"},"✓ ",o("Updates Provided Till","arts-license-pro")," ",r))}if(m.expires&&("lifetime"===m.expires?e.push(React.createElement("li",{key:"expires"},"✓ ",o("Lifetime License","arts-license-pro"))):e.push(React.createElement("li",{key:"expires"},"✓ ",o("Expires","arts-license-pro"),": ",m.expires))),void 0!==m.site_count&&void 0!==m.license_limit){0===Number(m.license_limit)||"unlimited"===m.activations_left?e.push(React.createElement("li",{key:"activations"},"✓ ",o("Unlimited Activations","arts-license-pro"))):e.push(React.createElement("li",{key:"activations"},"✓ ",o("Activations","arts-license-pro"),": ",m.site_count,"/",m.license_limit))}x=React.createElement("div",{className:"arts-license-pro-info"},React.createElement("ul",{className:"arts-license-pro-info__list"},e))}else x=React.createElement("span",null,o("Enter Your License Key","arts-license-pro"),"."," ",React.createElement(a,{showWrapper:!1,renderAsLink:!0,href:f.purchaseUrl,text:o("Get License Key","arts-license-pro")}));return React.createElement("div",{className:"arts-license-pro-form"},React.createElement("div",{className:"arts-license-pro-form__input-wrapper"},React.createElement(c,{value:y,onChange:e=>{g(e),E(null),L(!1)},onKeyDown:e=>{"Enter"===e.key&&!u&&y.trim()&&(e.preventDefault(),A())},placeholder:"XXXXXXXX-XXXXXXXX-XXXXXXXX-XXXXXXXX",help:x,className:v||R&&h?"has-error":"",disabled:p||X||u,readOnly:u}),React.createElement(r,{variant:u?"secondary":"primary",type:"button",onClick:u?async()=>{if(confirm(o("Are you sure you want to deactivate this license?","arts-license-pro")))try{await t(),g(""),_&&window.location.reload()}catch(e){L(!0)}}:A,isBusy:p||X,disabled:p||X||!u&&!y.trim(),isDestructive:u&&!X,className:"arts-license-pro-form__button"},o(X?"Refreshing...":p?u?"Deactivating...":"Activating...":u?"Deactivate":"Activate","arts-license-pro"))))}const{useState:p}=wp.element;function d({initialLicense:e,licenseConfig:t,licenseAPI:a,shouldRefreshPageOnLicenseChange:s=!0,shouldAutoRefreshLicenseOnMount:n=!1}){const{license:r,isLoading:c,error:i,activateLicense:o,deactivateLicense:d,refreshLicense:u}=function(e){const[t,a]=p(e.initialLicense),[s,n]=p(!1),[r,c]=p(null);return{license:t,isLoading:s,error:r,activateLicense:async t=>{n(!0),c(null);try{const s=await e.api.activate(t);a(s)}catch(e){const t=e instanceof Error?e.message:"Activation failed";throw c(t),e}finally{n(!1)}},deactivateLicense:async()=>{n(!0),c(null);try{await e.api.deactivate(),a(null)}catch(e){const t=e instanceof Error?e.message:"Deactivation failed";throw c(t),e}finally{n(!1)}},refreshLicense:async()=>{n(!0),c(null);try{const t=await e.api.check();a(t)}catch(e){const t=e instanceof Error?e.message:"Failed to refresh license";throw c(t),e}finally{n(!1)}}}}({initialLicense:e,api:a}),m=r&&"valid"===r.status,h=r?.license_key||null;return React.createElement("div",{className:"arts-license-pro-panel"},React.createElement(l,{onActivate:o,onDeactivate:d,onRefresh:u,isLoading:c,licenseKey:h,isActivated:!!m,license:r,apiError:i,licenseConfig:t,shouldRefreshPageOnLicenseChange:s,shouldAutoRefreshLicenseOnMount:n}))}class u{productSlug;ajaxUrl;nonce;constructor(e,t,a){this.productSlug=e,this.ajaxUrl=t,this.nonce=a}async activate(e){const t=new URLSearchParams({action:`${this.productSlug}_license_activate`,_wpnonce:this.nonce,license_key:e}),a=await fetch(this.ajaxUrl,{method:"POST",body:t}),s=await a.json();if(!s.success)throw new Error(s.data?.message||"Activation failed");return s.data}async deactivate(){const e=new URLSearchParams({action:`${this.productSlug}_license_deactivate`,_wpnonce:this.nonce}),t=await fetch(this.ajaxUrl,{method:"POST",body:e}),a=await t.json();if(!a.success)throw new Error(a.data?.message||"Deactivation failed")}async check(){const e=new URLSearchParams({action:`${this.productSlug}_license_check`,_wpnonce:this.nonce}),t=await fetch(this.ajaxUrl,{method:"POST",body:e}),a=await t.json();if(!a.success){if("No license found"===a.data?.message)return null;throw new Error(a.data?.message||"Check failed")}return a.data}}const{createElement:m,render:h}=wp.element;function f(){if(!window.artsLicenseProInstances)return;document.querySelectorAll(".arts-license-pro-license-panel-root").forEach((e=>{const t=e.getAttribute("data-product"),a=window.artsLicenseProInstances[t];if(!a)return;const s=new u(a.productSlug,a.ajaxUrl,a.nonce);h(m(d,{initialLicense:a.initialLicense,licenseConfig:a.config,licenseAPI:s}),e)}));document.querySelectorAll(".arts-license-pro-badge-root").forEach((e=>{const t=e.getAttribute("data-config");if(t)try{const s=JSON.parse(t);h(m(a,s),e)}catch(e){}}))}return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",f):f(),e=e.default})()));